sap.ui.define(["efolder/sap/ZEJECUCION/controller/main.controller","../util/utils","../service/service","efolder/efol/BSP_SAPMUTILS/service/ServiceExpediente","efolder/efol/BSP_SAPMUTILS/model/CoreModel","efolder/sap/ZACTUACION/controller/fragment/genericListHelp","efolder/sap/ZEJECUCION_RE/controller/fragment/customListHelp","efolder/sap/ZACTUACION/controller/fragment/genericTableHelp","sap/ui/core/util/Export","sap/ui/core/util/ExportTypeCSV","sap/ui/export/Spreadsheet","sap/m/Dialog","sap/m/DialogType","sap/m/Button","sap/m/ButtonType","sap/m/Text","sap/ui/core/ValueState","sap/ui/model/Filter","sap/ui/model/FilterOperator","efolder/sap/ZEJECUCION_RE/controller/fragment/bucketHR"],(function(e,t,o,i,a,l,r,s,n,d,g,c,p,u,C,f,m,S,h,y){"use strict";return e.extend("efolder.sap.ZEJECUCION_RE.controller.main",{onAfterRendering:function(){this.jsonColumns={IdUc:!0,Cuitxt:!0,DescripcionCu:!0,ImpUnitUFD:!1,ImpUnitEC:!0,CompInicial:!0,UltRefAut:!0,CantCertificada:!0,PdtAutRef:!0,ImpUnit:!1,ImpUltautUfd:!1,ImpCertificadoUFD:!1,ImpTotalPdteUFD:!1,Desvio:!1,DesvioImp:!1,ImpCompInicial:!0,ImpUltAut:!0,ImpCertificado:!0,ImpTotalPdteAutorizar:!0,InsCodSap:!0,InsMatricula:!0,Hlevel:!0,TipoActivo:!0,InstRefCodSap:!0,InstRefMaquina:!0,IdReformado:!0,LineId:!0,Cutyp:!0},this.getView().setModel(new sap.ui.model.json.JSONModel(this.jsonColumns),"oVisibleModel")},openUCtypeV:function(){a.odataModelHelp.read("/SH_JerTipoActSet",{success:function(e){this.SH_JerTipoActSet=e.results,this._oDialogUCtypeV||(this._oDialogUCtypeV=sap.ui.xmlfragment("efolder/sap/ZEJECUCION_RE/fragment/dialogUCtypeV",this),this.getView().addDependent(this._oDialogUCtypeV));e=a.jsonModelEje.getProperty("/CertificacionRESet");for(var t in(e=e.filter((()=>!0))).shift(),e=(e=(e=(e=e.filter((e=>"V"===e.Cutyp))).filter((e=>""!==e.InstRefCodSap))).filter((e=>""!==e.Jerarquia))).reverse(),e=[...new Map(e.map((e=>[e.InstRefCodSap,e]))).values()])for(var o in this.SH_JerTipoActSet)if(e[t].Jerarquia===this.SH_JerTipoActSet[o].Jerarquia){e[t]._insRefTxt=this.SH_JerTipoActSet[o].TipoActivo+" "+e[t].InstRefCodSap;break}a.jsonModelHelp.setProperty("/CertificacionRESetFiltrado",e),this._oDialogUCtypeV.setModel(new sap.ui.model.json.JSONModel({}),"modelFilter"),this._oDialogUCtypeV.open()}.bind(this),error:function(e){console.log(e)}})},genericHelpRequestTableAddPC:function(e){if(this.instalacionSelect()){var t=this.getView().byId("oTableReformado"),o=t.getSelectedIndex(),i=t.getContextByIndex(o).getObject();if(console.log(o),"0000000000"!==i.IdUc){for(var l=this.getView().getModel("jsonModelEje").getProperty("/CertificacionRESet"),r=o+1;r<l.length&&"V"!==l[r].Cutyp;)r++;var n=i.Hlevel,d=i.IdUc,g=i.IdReformado,S=i.InsMatricula,h=i.UbTec;s.show(this.getView(),function(e){var t={};for(var o in t.InsMatricula=S,t.UbTec=h,t.LineId="",t.CuClass=e.getBindingContext("odataModelUCC").getObject().CuClass,t.DescCuClass=e.getBindingContext("odataModelUCC").getObject().DescCuClass,t.Tipex=a.EFOLDER_CABECERA.getProperty("/Tipex"),t.Gjahr=a.EFOLDER_CABECERA.getProperty("/Gjahr"),t.Numex=a.EFOLDER_CABECERA.getProperty("/Numex"),t.OrigenCert="ZEJECUCION_RE",t.Hlevel=(parseInt(n)+1).toString(),t.CuIdSup=d,t._isNew=!0,t.NewLine=!0,t._lastIdRef=!0,t.CompIni=e.getBindingContext("odataModelUCC").getObject().CompIni,t.UltRefAut=e.getBindingContext("odataModelUCC").getObject().CompIni,t.PdtAutRef=e.getBindingContext("odataModelUCC").getObject().Cantidad,t.IdReformado=g,t.ImpUnit=e.getBindingContext("odataModelUCC").getObject().ImpUnit,t.IdUc=e.getBindingContext("odataModelUCC").getObject().CuId,t.Cuitxt=e.getBindingContext("odataModelUCC").getObject().Cutxt,t.Cutyp=e.getBindingContext("odataModelUCC").getObject().Cutyp,t.Ultimo=!1,l.sort(((e,t)=>e.LineId<t.LineId?-1:e.LineId>t.LineId?1:0)),l.splice(r,0,t),l)l[o].LineId=Number(o)+1;a.jsonModelEje.setProperty("/CertificacionRESet",l),a.jsonModelEje.refresh(),a.jsonModelEje.firePropertyChange()}.bind(this),"/UnidadCompatibleSet","odataModelUCC>",["Cutyp","CuId","Cutxt","CuType","DescCuType","Vtext","PrSer","PrMat"],["CuId","Cutxt","CuType","DescCuType"],[new sap.ui.model.Filter("IdPantalla","EQ","ZEJECUCION_RE"),new sap.ui.model.Filter("Tipex","EQ",a.EFOLDER_CABECERA.getProperty("/Tipex")),new sap.ui.model.Filter("Gjahr","EQ",a.EFOLDER_CABECERA.getProperty("/Gjahr")),new sap.ui.model.Filter("Numex","EQ",a.EFOLDER_CABECERA.getProperty("/Numex"))])}else this.oSelectDialog||(this.oSelectDialog=new c({type:p.Message,title:"Error",state:m.Error,content:new f({text:"{i18n>SeleccionarInstalacionNoCabecera}"}),beginButton:new u({type:C.Emphasized,text:"OK",press:function(){this.oSelectDialog.destroy(),this.oSelectDialog=null}.bind(this)})}),this.getView().addDependent(this.oSelectDialog)),this.oSelectDialog.open()}else{this.getView().getModel("i18n").getResourceBundle();this.oSelectDialog||(this.oSelectDialog=new c({type:p.Message,title:"Error",state:m.Error,content:new f({text:"{i18n>SeleccionarInstalacion}"}),beginButton:new u({type:C.Emphasized,text:"OK",press:function(){this.oSelectDialog.destroy(),this.oSelectDialog=null}.bind(this)})}),this.getView().addDependent(this.oSelectDialog)),this.oSelectDialog.open()}},onDialogUCtypeVSearch:function(){var e=this._oDialogUCtypeV.getModel("modelFilter").getProperty("/"),t=[];for(var o in e)t.push(new sap.ui.model.Filter({path:o,operator:"EQ",value1:e[o]}));this._oDialogUCtypeV.getContent()[1].getContent()[0].getBinding().filter(t)},onDialogUCtypeVClear:function(){this._oDialogUCtypeV.getModel("modelFilter").setData({})},onDialogUCtypeVAccept:function(e){var t=this._oDialogUCtypeV.getModel("modelFilter").getData();console.log(t);var o=this.checkUCV();if(""!==t.tipoObj&&""!==t._CampoClasif&&""!==t._CodigoSAP&&""!==t._CampoClasif2&&""!==t._CodigoSAP2&&t.tipoObj&&t._CampoClasif&&t._CodigoSAP&&t._CampoClasif2&&t._CodigoSAP2)if(o)sap.m.MessageToast.show(this.getView().getModel("i18n").getResourceBundle().getText(o));else{var i=this.getView().byId("oTableReformado"),l=this.getView().getModel("jsonModelEje").getProperty("/CertificacionRESet"),r=l.map((function(e){return"V"===e.Cutyp?e.IdUc:null})),s=Math.max.apply(null,r),n=i.getContextByIndex(0).getObject(),d=n.Hlevel,g=n.IdUc,c=n.IdReformado,p={LineId:"",Cuitxt:t.descrip,UbTec:t._CodigoSAP2,InsMatricula:"E"===t.tipoObj?t.obj:"",CuType:"",Cutyp:"V",Hlevel:(parseInt(d)+1).toString(),CompIni:"1",CuIdSup:g,UltRefAut:"1",PdtAutRef:"1",IdReformado:c,IdUc:(parseInt(s)+1).toString(),NewLine:!0,_isNew:!0,Tipex:a.EFOLDER_CABECERA.getProperty("/Tipex"),Gjahr:a.EFOLDER_CABECERA.getProperty("/Gjahr"),Numex:a.EFOLDER_CABECERA.getProperty("/Numex"),OrigenCert:"ZEJECUCION_RE",InstRefCodSap:t._CodigoSAP,InsCodSap:t._CodigoSAP2,InsMatricula:t._matricula2,InstRefMaquina:t._matricula,TipoActivo:t._CampoClasif2};l.push(p),this.reasignarIdLine(),this.getView().getModel("jsonModelEje").refresh(),this._oDialogUCtypeV.close(),i.setSelectedIndex(-1),a.jsonModelEje.firePropertyChange()}else sap.m.MessageToast.show(this.getView().getModel("i18n").getResourceBundle().getText("faltanCampos"))},onDialogUCtypeVCancel:function(){this._oDialogUCtypeV.close()},onValueHelpUT:function(e){var t=e.getSource(),o=this.getView().getModel("jsonModelEje");a.odataModelHelp.read("/SH_UbicacionTecnicaSet",{filters:[new sap.ui.model.Filter("Zona","EQ",o.getProperty("/Zona")),new sap.ui.model.Filter("Delegacion","EQ",o.getProperty("/Delegacion"))],success:function(e){a.jsonModelHelp.setProperty("/SH_UbicacionTecnicaSet",e.results),a.jsonModelHelp.setProperty("/SH_UbicacionTecnicaSet/noBusy",!0)}}),l.show(this.getView(),function(e){t.setValue(e.getBindingContext("jsonModelHelp").getObject().UbicacionTecnica),t.getModel("modelFilter").setProperty("/descrip",e.getBindingContext("jsonModelHelp").getObject().DescUbicacionTecnica)}.bind(this),"/SH_UbicacionTecnicaSet","UbicacionTecnica","DescUbicacionTecnica","jsonModelHelp>",void 0,void 0,!1)},onValueHelpEquipo:function(e){var t=e.getSource(),o=this.getView().getModel("jsonModelEje");a.odataModelHelp.read("/SH_EquipoSet",{filters:[new sap.ui.model.Filter("Zona","EQ",o.getProperty("/Zona")),new sap.ui.model.Filter("Delegacion","EQ",o.getProperty("/Delegacion"))],success:function(e){a.jsonModelHelp.setProperty("/SH_EquipoSet",e.results),a.jsonModelHelp.setProperty("/SH_EquipoSet/noBusy",!0)}}),l.show(this.getView(),function(e){t.setValue(e.getBindingContext("jsonModelHelp").getObject().InsMatricula),t.getModel("modelFilter").setProperty("/descrip",e.getBindingContext("jsonModelHelp").getObject().DescEquipo)}.bind(this),"/SH_EquipoSet","Equipo","DescEquipo","jsonModelHelp>",void 0,void 0,!1)},deleteRow:function(e){var t=e.getSource().getBindingContext("jsonModelEje").getObject(),o=e.getSource().getModel("jsonModelEje").getData().CertificacionRESet,i=e.getSource().getModel("jsonModelEje").getData().CertificacionesDelete;if("V"!==t.Cutyp){for(var l in o)if(o[l].LineId===t.LineId){t.Borrar=!0,t._isNew||i.push(t),o.splice(l,1);break}}else{var r=e.getSource().getParent().getParent().getIndex(),s=0,n=t._nota;for(l=r;l<o.length&&-1!==o[l]._nota.indexOf(n);l++)o[l].Borrar=!0,o[l]._isNew||i.push(o[l]),s++;o.splice(r,s)}for(var l in o.sort(((e,t)=>e.LineId<t.LineId?-1:e.LineId>t.LineId?1:0)),o)o[l].LineId=Number(l)+1;this.getView().getModel("jsonModelEje").refresh(),a.jsonModelEje.firePropertyChange()},onPdtAutRefChange:function(e){var t=e.getSource().getParent().getParent().getIndex(),o=this.byId("oTableReformado"),i=Number(o.getContextByIndex(t).getProperty("UltRefAut"));e.getSource().getValueState()===sap.ui.core.ValueState.Error&&(e.getSource().setValue(i),e.getSource().setValueState(sap.ui.core.ValueState.None),sap.m.MessageToast.show(this.getView().getModel("i18n").getProperty("errorInput")));var a=e.getSource().getBindingContext("jsonModelEje").getObject();if("3"===a.Cutyp)var l=sap.ui.core.format.NumberFormat.getFloatInstance({minFractionDigits:1,maxFractionDigits:1,groupingEnabled:!1,decimalSeparator:"."});else l=sap.ui.core.format.NumberFormat.getFloatInstance({minFractionDigits:3,groupingEnabled:!1,decimalSeparator:"."});a.PdtAutRef=a.PdtAutRef.replace(",","."),a.PdtAutRef=l.format(a.PdtAutRef),a.PdtAutRef>=99999.99&&(e.getSource().setValue("99999.990"),sap.m.MessageToast.show(this.getView().getModel("i18n").getResourceBundle().getText("valorMaximo"))),"1"===a.Cutyp&&a.PdtAutRef!=parseInt(a.PdtAutRef)?e.getSource().setValueState("Error"):e.getSource().setValueState("None")},comprobarCantidadLive:function(e){var t=Number(e.getParameter("value")),o=e.getSource().getParent().getParent().getIndex(),i=this.byId("oTableReformado"),a=Number(i.getContextByIndex(o).getProperty("CantCertificada"));console.log(a),t<a?e.getSource().setValueState(sap.ui.core.ValueState.Error):e.getSource().setValueState(sap.ui.core.ValueState.None)},onDialogColumns:function(){var e=this.getView().getModel("i18n").getResourceBundle();this._dialogColumns||(this._dialogColumns=new sap.m.SelectDialog({title:"Marca o desmarca columnas",multiSelect:!0,search:function(e){var t=e.getParameter("value"),o=new S("name",h.Contains,t);e.getParameter("itemsBinding").filter([o])}}),this._dialogColumns.addStyleClass("dialogColumns"),this._dialogColumns.bindAggregation("items",{path:"columns>/",template:new sap.m.StandardListItem({title:"{columns>name}",selected:"{columns>selected}"})}),this._dialogColumns.attachConfirm(function(e){var t=this.getView().getModel("columns").getData();for(var o in t)this.jsonColumns[t[o].field]=t[o].selected;this.getView().getModel("oVisibleModel").refresh()}.bind(this)),this.getView().addDependent(this._dialogColumns));var t=[];for(var o in this.jsonColumns)this.getView().getModel("oVisibleModel").getData()[o]&&t.push({field:o,selected:this.jsonColumns[o],name:e.getText(o)});this.getView().setModel(new sap.ui.model.json.JSONModel(t),"columns"),this._dialogColumns.open()},onSaveExcel:function(){var e,t=[];for(var o in this.jsonColumns)this.jsonColumns[o]&&t.push({label:this.getView().getModel("i18n").getResourceBundle().getText(o),property:o});this._oTable||(this._oTable=this.byId("oTableReformado")),this._oTable,e={workbook:{columns:t},dataSource:this._oTable.getBinding("rows").getModel("jsonModelEje").getProperty("/CertificacionRESet"),fileName:"Table export.xlsx",worker:!0};var i=new sap.ui.export.Spreadsheet(e);i.build().finally((function(){i.destroy()}))},onSelectVariant:function(){this._oDialogUCtypeV.getModel("modelFilter").setData({_CampoClasif:""},!0),this._oDialogUCtypeV.getModel("modelFilter").setData({_CodigoSAP:""},!0),this._oDialogUCtypeV.getModel("modelFilter").setData({_CampoClasif2:""},!0),this._oDialogUCtypeV.getModel("modelFilter").setData({_CodigoSAP2:""},!0)},tipoActivoChanged:function(){this._oDialogUCtypeV.getModel("modelFilter").setData({_CodigoSAP:""},!0),this._oDialogUCtypeV.getModel("modelFilter").setData({_CampoClasif2:""},!0),this._oDialogUCtypeV.getModel("modelFilter").setData({_CodigoSAP2:""},!0)},tipoActivoChanged2:function(){this._oDialogUCtypeV.getModel("modelFilter").setData({_CodigoSAP2:""},!0)},onOtherInsRef:function(e){this._oDialogUCtypeV.getModel("modelFilter").setData({}),this._oDialogUCtypeV.getModel("modelFilter").setProperty("/_otherRef",!0)},valueHelpRequestTipoActivo:function(e){var t=e.getSource();this.getView().getModel("jsonModelEje"),a.odataModelHelp.read("/SH_TipoActivoSet",{filters:[new sap.ui.model.Filter("Jerarquia","EQ",sap.ui.getCore().byId("sJerarquia").getSelectedKey())],success:function(e){a.jsonModelHelp.setProperty("/SH_TipoActivoSet",e.results),a.jsonModelHelp.setProperty("/SH_TipoActivoSet/noBusy",!0)}}),l.show(this.getView(),function(e){t.setValue(e.getBindingContext("jsonModelHelp").getObject().UbicacionTecnica),t.getModel("modelFilter").setProperty("/descrip",e.getBindingContext("jsonModelHelp").getObject().DescUbicacionTecnica)}.bind(this),"/SH_TipoActivoSet","UbicacionTecnica","DescUbicacionTecnica","jsonModelHelp>",void 0,void 0,!1)},valueHelpRequestCodActivo:function(e){var t=e.getSource(),o=this.getView().getModel("jsonModelEje"),i=t.getModel("modelFilter");a.odataModelHelp.read("/SH_CodigoActivo",{filters:[new sap.ui.model.Filter("CampoClasif","EQ",i.getProperty("/_CampoClasif")),new sap.ui.model.Filter("Recid","EQ",o.getProperty("/Recid")),new sap.ui.model.Filter("Jerarquia","EQ",i.getProperty("/tipoObj"))],success:function(e){a.jsonModelHelp.setProperty("/SH_CodigoActivo",e.results),a.jsonModelHelp.setProperty("/SH_CodigoActivo/noBusy",!0)}}),r.show(this.getView(),function(e){i.setProperty("/_CodigoSAP",e.getBindingContext("jsonModelHelp").getObject().CodigoSAP),i.setProperty("/descrip",e.getBindingContext("jsonModelHelp").getObject().DescInstalacion),i.setProperty("/_matricula",e.getBindingContext("jsonModelHelp").getObject().Matricula),i.setProperty("/_codigoGistag",e.getBindingContext("jsonModelHelp").getObject().CodigoGISTAG)}.bind(this),"/SH_CodigoActivo","CodigoSAP","CodigoSAP;DescInstalacion;Matricula;CodigoGISTAG","jsonModelHelp>",void 0,void 0,!1)},instalacionSelect:function(){var e=this.getView().byId("oTableReformado").getSelectedIndex();return e>-1&&"V"===this.getView().byId("oTableReformado").getContextByIndex(e).getObject().Cutyp},checkUCV:function(){var e=this.getView().getModel("jsonModelEje").getData().GastoInv,t=this._oDialogUCtypeV.getModel("modelFilter").getData(),o=t.tipoObj,i=this._oDialogUCtypeV.getModel("modelFilter").getData()._CampoClasif2.charAt(1),a=this.getView().getModel("jsonModelEje").getData().CertificacionRESet,l=jQuery.sap.extend(!0,[],a);if(l.shift(),(l=l.filter((e=>"V"===e.Cutyp))).find((e=>e.InsCodSap===t._CodigoSAP2)))return"exiteInstalacion";if("I"!==e)return!1;switch(o){case"CT":if(i<"2")return"nivel2";break;case"SE":case"LI":if(i<"3")return"nivel3"}},bucketHelpRequest:function(e){this.getView().getController();var t=e.getSource(),o=t.getModel("modelFilter");let i={sJerarquia:t.getModel("modelFilter").getProperty("/tipoObj"),sGuid:t.getModel("modelFilter").getProperty("/_refPRevia")};y.show(this.getView(),function(e){o.setProperty("/_CampoClasif",e.CampoClasif),this.tipoActivoChanged(),o.setProperty("/_CampoClasif2",e.CampoClasif),this.tipoActivoChanged2()}.bind(this),i)},bucketHelpRequest2:function(e){this.getView().getController();var t=e.getSource(),o=t.getModel("modelFilter");let i={sJerarquia:t.getModel("modelFilter").getProperty("/tipoObj"),CampoClasif:t.getModel("modelFilter").getProperty("/_CampoClasif")};y.show(this.getView(),function(e){o.setProperty("/_CampoClasif2",e.CampoClasif),this.tipoActivoChanged2()}.bind(this),i)},valueHelpRequestCodActivo2:function(e){var t=e.getSource(),o=this.getView().getModel("jsonModelEje"),i=t.getModel("modelFilter");a.odataModelHelp.read("/SH_CodigoActivo",{filters:[new sap.ui.model.Filter("CampoClasif","EQ",i.getProperty("/_CampoClasif2")),new sap.ui.model.Filter("Recid","EQ",o.getProperty("/Recid")),new sap.ui.model.Filter("CodigoSAP","EQ",i.getProperty("/_CodigoSAP")),new sap.ui.model.Filter("Jerarquia","EQ",i.getProperty("/tipoObj"))],success:function(e){a.jsonModelHelp.setProperty("/SH_CodigoActivo",e.results),a.jsonModelHelp.setProperty("/SH_CodigoActivo/noBusy",!0)}}),r.show(this.getView(),function(e){i.setProperty("/_CodigoSAP2",e.getBindingContext("jsonModelHelp").getObject().CodigoSAP),i.setProperty("/descrip2",e.getBindingContext("jsonModelHelp").getObject().DescInstalacion),i.setProperty("/_matricula2",e.getBindingContext("jsonModelHelp").getObject().Matricula),i.setProperty("/_codigoGistag2",e.getBindingContext("jsonModelHelp").getObject().CodigoGISTAG)}.bind(this),"/SH_CodigoActivo","CodigoSAP","CodigoSAP;DescInstalacion;Matricula;CodigoGISTAG","jsonModelHelp>",void 0,void 0,!1)},onRefPreviaSelected:function(e){var t=e.getSource().getModel("modelFilter"),o=this.getView().byId("oTableReformado");o.setSelectedIndex(-1);var i,l=e.oSource.getSelectedKey();for(var r in o.getBinding().getContext().getModel().getData().CertificacionRESet)if(o.getBinding().getContext().getModel().getData().CertificacionRESet[r].IdUc===l){i=o.getBinding().getContext().getModel().getData().CertificacionRESet[r],o.setSelectedIndex(parseInt(r));break}a.odataModelHelp.read("/SH_JerTipoActSet",{success:function(e){this.SH_JerTipoActSet=e.results;var o=this.SH_JerTipoActSet.find((e=>e.Jerarquia===i.Jerarquia)).TipoActivo;console.log(this.SH_JerTipoActSet),t.setProperty("/tipoObj",i.Jerarquia),t.setProperty("/_CampoClasif",o),t.setProperty("/_CampoClasif2",o),t.setProperty("/_CodigoSAP",i.InstRefCodSap),console.log(i),a.odataModelHelp.read("/SH_CodigoActivo",{filters:[new sap.ui.model.Filter("CampoClasif","EQ",t.getProperty("/_CampoClasif")),new sap.ui.model.Filter("Recid","EQ",a.jsonModelEje.getProperty("/Recid")),new sap.ui.model.Filter("Jerarquia","EQ",t.getProperty("/tipoObj"))],success:function(e){const o=e.results.find((e=>e.CodigoSAP===i.InstRefCodSap));t.setProperty("/descrip",o.DescInstalacion),t.setProperty("/_matricula",o.Matricula),t.setProperty("/_codigoGistag",o.CodigoGISTAG)}.bind(this),error:function(e){console.log(e)}})}.bind(this),error:function(e){console.log(e)}})},codActivoSelected:function(e){let t=e.getParameter("value");var o=e.getSource().getModel("modelFilter");a.odataModelHelp.read("/SH_CodigoActivo",{filters:[new sap.ui.model.Filter("CampoClasif","EQ",o.getProperty("/_CampoClasif"))],success:function(e){if(e.results.length>0){let o=e.results.find((e=>e.CodigoSAP===t));o?this.setCodigoActivo(o):this.clearCodigoActivo()}else this.clearCodigoActivo()}.bind(this)})},setCodigoActivo:function(e){var t=this._oDialogUCtypeV.getModel("modelFilter");t.setProperty("/_CodigoSAP",e.CodigoSAP),t.setProperty("/descrip",e.DescInstalacion),t.setProperty("/_matricula",e.Matricula),t.setProperty("/_codigoGistag",e.CodigoGISTAG)},clearCodigoActivo:function(){var e=this._oDialogUCtypeV.getModel("modelFilter");e.setProperty("/_CodigoSAP",""),e.setProperty("/descrip",""),e.setProperty("/_matricula",""),e.setProperty("/_codigoGistag","")},codActivoSelected2:function(e){let t=e.getParameter("value");var o=e.getSource().getModel("modelFilter");a.odataModelHelp.read("/SH_CodigoActivo",{filters:[new sap.ui.model.Filter("CampoClasif","EQ",o.getProperty("/_CampoClasif2"))],success:function(e){if(e.results.length>0){let o=e.results.find((e=>e.CodigoSAP===t));o?this.setCodigoActivo2(o):this.clearCodigoActivo2()}else this.clearCodigoActivo2()}.bind(this)})},setCodigoActivo2:function(e){var t=this._oDialogUCtypeV.getModel("modelFilter");t.setProperty("/_CodigoSAP2",e.CodigoSAP),t.setProperty("/descrip2",e.DescInstalacion),t.setProperty("/_matricula2",e.Matricula),t.setProperty("/_codigoGistag2",e.CodigoGISTAG)},clearCodigoActivo2:function(){var e=this._oDialogUCtypeV.getModel("modelFilter");e.setProperty("/_CodigoSAP2",""),e.setProperty("/descrip2",""),e.setProperty("/_matricula2",""),e.setProperty("/_codigoGistag2","")}})}));