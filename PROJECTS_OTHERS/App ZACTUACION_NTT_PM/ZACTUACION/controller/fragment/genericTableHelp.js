sap.ui.define(["sap/ui/core/Fragment"],(function(e){return{init:function(e,t){this.oView=e,this._oPopover||(this._oPopover=sap.ui.xmlfragment("efolder/sap/ZACTUACION/fragment/genericTableHelp",this),e.addDependent(this._oPopover))},show:function(e,t,i,n,a,o,l){this.fields=a,this.fieldsFilter=o,this.additionalFilter=l,this._oPopover||this.init(e),this.functionOk=t;var s=this._oPopover.getContent()[1],r=this._oPopover.getContent()[0];s.removeAllColumns(),r.removeAllContent();var d=new sap.m.ColumnListItem({type:"Active"}),p=new sap.m.FlexBox({direction:"Column"}),u=new sap.m.Panel({backgroundDesign:"Transparent"}).addStyleClass("sapUiSizeCompact");p.addItem(u);var m=new sap.m.FlexBox({alignItems:"Start",justifyContent:"Center",items:[new sap.m.Button({text:"{i18n>buscar}",press:function(){var e=this._oPopover.getContent()[1],t=e.getBinding("items"),i=e.getModel("filterModel").getProperty("/filters"),n=[];for(var a in this.additionalFilter&&(n=jQuery.extend(!0,[],this.additionalFilter)),i)i[a]&&n.push(new sap.ui.model.Filter(a,"EQ",i[a]));t.filter(n)}.bind(this)}).addStyleClass("sapUiSmallMarginEnd"),new sap.m.Button({text:"{i18n>limpiar}",press:function(){this._oPopover.getContent()[1].getModel("filterModel").setProperty("/filters",{})}.bind(this)})]});p.addItem(m);var h=new sap.ui.model.json.JSONModel({filters:{}});for(var c in this._oPopover.setModel(h,"filterModel"),a)s.addColumn(new sap.m.Column({header:new sap.m.Label({text:"{i18n>"+a[c]+"}"})})),"PrSer"===a[c]||"PrMat"===a[c]?d.addCell(new sap.m.Label({text:{parts:[{path:n+a[c]},{path:"oViewModel>/currency"}],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:!0}}})):"Kdatb"===a[c]||"Kdate"===a[c]?d.addCell(new sap.m.Label({text:{path:n+a[c],type:"sap.ui.model.type.Date",formatOptions:{pattern:"dd/MM/yyyy",UTC:!0}}})):d.addCell(new sap.m.Label({text:"{"+n+a[c]+"}"}));for(var c in o){var f=new sap.m.Panel({backgroundDesign:"Transparent",width:"auto"}).addStyleClass("sapUiSmallMarginEnd").addStyleClass("sapUiNoContentPadding").addStyleClass("panelInline");u.addContent(f),f.addContent(new sap.m.Label({text:"{i18n>"+o[c]+"}:"}).addStyleClass("sapUiTinyMarginTop")),"Kdatb"===o[c]||"Kdate"===o[c]?f.addContent(new sap.m.DatePicker({dateValue:"{filterModel>/filters/"+o[c]+"}",width:"auto"})):f.addContent(new sap.m.Input({value:"{filterModel>/filters/"+o[c]+"}",width:"auto"}))}r.addContent(p),s.bindAggregation("items",{path:n+i,template:d}),this.additionalFilter&&s.getBinding("items").filter(this.additionalFilter),this._oPopover.getContent()[1].bindProperty("busy",n+i+"/noBusy",(function(e){return!e})),this._oPopover.open()},hide:function(){this._oPopover&&this._oPopover.close()},closeGenericVHelp:function(e){},confirmGenericVHelp:function(e){this.functionOk(this.multiselect?e.getParameter("selectedItems"):e.getParameter("selectedItem"))},onSearchGenericVHelp:function(e){var t=e.getParameter("itemsBinding");t.aApplicationFilters=[];var i=e.getParameter("value"),n=[];this.additionalFilter&&(n=jQuery.extend(!0,[],this.additionalFilter)),this.field?n.push(new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("Field","EQ",this.field),new sap.ui.model.Filter("Text","EQ",i),new sap.ui.model.Filter("Id","EQ",i),new sap.ui.model.Filter("Type","EQ",this.internalField),new sap.ui.model.Filter("Validar","EQ","")],and:!0})):i&&n.push(new sap.ui.model.Filter({filters:[new sap.ui.model.Filter(this.key,sap.ui.model.FilterOperator.Contains,i),new sap.ui.model.Filter(this.text,sap.ui.model.FilterOperator.Contains,i)],and:!1})),t.filter(n)},setSelectedValuesMultiSelect:function(e){this.selectedValuesMultiSelect=e},selectedRow:function(e){this._oPopover.getContent()[1].getSelectedItem()&&(this.functionOk(this._oPopover.getContent()[1].getSelectedItem()),this._oPopover&&this._oPopover.close())}}}));